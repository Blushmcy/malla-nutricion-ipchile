<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Malla NutriciÃ³n - IPCHILE</title>
<style>
  :root{
    --lila:#8d2bf3;
    --lila-claro: #ecd9ff;
    --lila-pale: #f0e3ff;
    --rosa: #ff69b4;
  }
  body {
    margin: 0;
    padding: 30px;
    font-family: "Inter", "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(135deg, #fff6fb 0%, #f3edff 50%, #efeaff 100%);
    color: #2c1b3a;
    min-height: 100vh;
    position: relative;
    -webkit-font-smoothing:antialiased;
  }

  h1{
    text-align:center;
    margin: 0 0 18px 0;
    color: #b86bff;
    font-weight:800;
    letter-spacing: -.2px;
    font-size: 24px;
  }

  .reset-btn {
    display:block;
    margin: 0 auto 20px auto;
    padding: 10px 18px;
    border-radius: 14px;
    background: linear-gradient(180deg, rgba(255,255,255,0.55), rgba(255,250,255,0.6));
    border: 1px solid rgba(200,170,255,0.55);
    box-shadow: 0 8px 20px rgba(150,100,230,0.12);
    backdrop-filter: blur(6px);
    color: var(--lila);
    font-weight:700;
    cursor:pointer;
    transition: all .25s ease;
  }
  .reset-btn:hover{
    transform: translateY(-3px);
    box-shadow: 0 12px 30px rgba(160,110,235,0.18);
  }
  .reset-btn:active{
    transform: scale(.96);
  }

  .nutria {
    position: absolute;
    font-size: 56px;
    opacity: 0.28;
    user-select: none;
    pointer-events: none;
    filter: drop-shadow(0 8px 24px rgba(140,80,200,0.08));
  }
  .nutria.n1 { top: 16px; left: 16px; transform: rotate(-8deg); }
  .nutria.n2 { top: 16px; right: 16px; transform: rotate(8deg); }
  .nutria.n3 { bottom: 18px; left: 26px; transform: rotate(-6deg); }
  .nutria.n4 { bottom: 18px; right: 26px; transform: rotate(6deg); }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 18px;
    max-width: 1100px;
    margin: 18px auto 70px auto;
  }

  .card {
    background: linear-gradient(180deg, rgba(255,255,255,0.55), rgba(255,250,255,0.6));
    border-radius: 18px;
    padding: 18px;
    border: 1px solid rgba(220,190,255,0.55);
    box-shadow: 0 8px 30px rgba(150,100,230,0.08);
    backdrop-filter: blur(8px) saturate(1.05);
    transition: transform .25s ease, box-shadow .25s ease;
  }
  .card:hover { transform: translateY(-6px); box-shadow: 0 14px 40px rgba(150,100,230,0.12); }
  .card h2 { margin: 0 0 8px 0; color: #9d54ff; font-size: 18px; }

  ul { list-style: none; padding: 0; margin: 0; display:block; }
  li { margin-bottom: 10px; }

  input[type="checkbox"] { display: none; }

  .ramo-label {
    display: inline-block;
    width: 100%;
    padding: 10px 12px;
    border-radius: 12px;
    cursor: pointer;
    user-select: none;
    transition: all .22s ease;
    font-weight: 600;
    color: #3b2646;
    background: rgba(255,255,255,0.0);
    position: relative;
  }

  .ramo-label:hover { transform: translateX(6px); background: rgba(250,230,255,0.7); }

  .ramo-label::before{
    content: "";
    display:inline-block;
    width:20px;
    height:20px;
    border-radius:6px;
    margin-right:10px;
    vertical-align:middle;
    background: rgba(240,235,255,0.9);
    border: 1px solid rgba(210,180,255,0.5);
    box-shadow: inset 0 -2px 6px rgba(0,0,0,0.03);
    text-align:center;
    line-height:20px;
    font-weight:700;
    color: var(--lila);
    transition: all .18s ease;
  }

  input[type="checkbox"]:checked + .ramo-label::before{
    content: "âœ”";
    background: linear-gradient(180deg, #fff, #f6f0ff);
    color: var(--lila);
    transform: scale(1.08);
    box-shadow: 0 6px 18px rgba(140,70,220,0.18);
  }

  input[type="checkbox"]:checked + .ramo-label{
    background: var(--lila-pale);
    border-radius: 14px;
    padding: 12px 14px;
    color: var(--lila);
    box-shadow: 0 8px 24px rgba(160,110,235,0.18);
    border: 1px solid rgba(200,170,255,0.55);
    transform: scale(1.01);
  }

  input[type="checkbox"]:disabled + .ramo-label{
    color: #a9a3ab;
    cursor: not-allowed;
    background: rgba(255,255,255,0.35);
  }

  @keyframes flotar { 
    0%{transform:translateY(0)}
    50%{transform:translateY(-8px) rotate(3deg)}
    100%{transform:translateY(0)}
  }
  .nutria { animation: flotar 4.5s ease-in-out infinite; }
  .nutria.n1{ animation-delay: 0s } 
  .nutria.n2{ animation-delay: .8s } 
  .nutria.n3{ animation-delay: 1.6s } 
  .nutria.n4{ animation-delay: 2.4s }

  @keyframes pop { 
    0%{transform:scale(1)}
    40%{transform:scale(1.22)}
    100%{transform:scale(1)}
  }
  input[type="checkbox"]:checked + .ramo-label::before { animation: pop .32s cubic-bezier(.2,.9,.2,1); }

  .watermark {
    position: fixed;
    right: 14px;
    bottom: 8px;
    font-size: 12px;
    color: #b58bff;
    opacity: .18;
    font-weight: 600;
    pointer-events: none;
    user-select: none;
    letter-spacing: .6px;
  }
</style>
</head>
<body>

<h1>Malla Curricular â€” NutriciÃ³n y DietÃ©tica (IPCHILE)</h1>

<button class="reset-btn" id="resetMalla">Reset malla</button>

<div class="nutria n1">ðŸ¦¦</div>
<div class="nutria n2">ðŸ¦¦</div>
<div class="nutria n3">ðŸ¦¦</div>
<div class="nutria n4">ðŸ¦¦</div>

<div class="grid" id="malla"></div>

<div class="watermark">@blushmcy</div>

<script>
const ramosPorNivel = [
  ["Anatomorfologia","BiologÃ­a Celular y Molecular","ComunicaciÃ³n Oral y Escrita","IntroducciÃ³n a la NutriciÃ³n","QuÃ­mica","Razonamiento LÃ³gico y MatemÃ¡tico"],
  ["BioquÃ­mica","Ciencia de los Alimentos I","FisiologÃ­a en el Ciclo Vital","InglÃ©s I","MicrobiologÃ­a e Higiene de los Alimentos","Primeros Auxilios"],
  ["BioestadÃ­stica","Ciencia de los Alimentos II","FisiopatologÃ­a en el Ciclo Vital","InglÃ©s II","NutriciÃ³n BÃ¡sica I","Inocuidad y calidad alimentaria],
  ["BromatologÃ­a y AnÃ¡lisis Sensorial","EvaluaciÃ³n del Estado Nutricional","FarmacologÃ­a","NutriciÃ³n BÃ¡sica II","Salud PÃºblica y EpidemiologÃ­a","Tecnicas Dieteticas"],
  ["cultura y GastronÃ³mica","Dietetica en el Ciclo Vital ","PsicologÃ­a para el Ciclo Vital","Produccion y Tecnologia Alimentaria","razonamiento clinico en nutricion","evaluacion nutricional para el ciclo vital"],
  ["BioÃ©tica Profesional","Dietoterapia en el Ciclo Vital I","Genetica y nutrigenemia","nutricion y Actividad FÃ­sica","educacion sociologia y conductas","planificacion alimentaria y nutricional"],
  ["AdministraciÃ³n y GestiÃ³n de Servicios de AlimentaciÃ³n","Dietoterapia en el Ciclo Vital III","EvaluaciÃ³n de Proyectos","NutriciÃ³n Comunitaria","nutricion ortomolecular","nutricion deportiva"],
  ["EvaluaciÃ³n de Proyectos y PlanificaciÃ³n","InvestigaciÃ³n en NutriciÃ³n","MÃ³dulo Integrativo en NutriciÃ³n ClÃ­nica","MÃ³dulo Integrativo en NutriciÃ³n Comunitaria","MÃ³dulo Integrativo en Servicios de AlimentaciÃ³n","terapias complementarias"],
  ["Internado Profesional","Proyecto de TÃ­tulo"],
];

const STORAGE_KEY = "mallaEstado_blushmcy_v1";
let estado = {};

try{
  const raw = localStorage.getItem(STORAGE_KEY);
  if(raw) estado = JSON.parse(raw);
}catch(e){ estado = {}; }

const mallaDiv = document.getElementById("malla");

ramosPorNivel.forEach((ramos, nivelIndex)=>{
  const card = document.createElement("div");
  card.className = "card";
  card.dataset.semestre = nivelIndex + 1;

  const title = document.createElement("h2");
  title.textContent = `Nivel ${nivelIndex+1}`;
  card.appendChild(title);

  const ul = document.createElement("ul");

  ramos.forEach((ramo, rIndex)=>{
    const li = document.createElement("li");

    const input = document.createElement("input");
    const id = `s${nivelIndex+1}r${rIndex+1}`;
    input.type = "checkbox";
    input.id = id;

    const label = document.createElement("label");
    label.className = "ramo-label";
    label.htmlFor = id;
    label.textContent = ramo;
    label.tabIndex = 0;

    li.appendChild(input);
    li.appendChild(label);
    ul.appendChild(li);

    if(estado[id]){
      input.checked = true;
    }
  });

  card.appendChild(ul);
  mallaDiv.appendChild(card);
});

function guardarEstado(){
  const map = {};
  document.querySelectorAll('input[type="checkbox"]').forEach(i=>{
    map[i.id] = !!i.checked;
  });
  estado = map;
  localStorage.setItem(STORAGE_KEY, JSON.stringify(estado));
}

function nivelCompletado(nivelIndex){
  const checks = [...document.querySelectorAll(`[data-semestre="${nivelIndex+1}"] input[type="checkbox"]`)];
  return checks.length > 0 && checks.every(i => i.checked);
}

function actualizarBloqueosDesdeEstado(){
  for(let i=0;i<ramosPorNivel.length;i++){
    const inputs = document.querySelectorAll(`[data-semestre="${i+1}"] input[type="checkbox"]`);

    if(i === 0){
      inputs.forEach(inp => inp.disabled = false);
      continue;
    }

    if(nivelCompletado(i-1)){
      inputs.forEach(inp => inp.disabled = false);
    } else {
      inputs.forEach(inp => inp.disabled = true);
    }
  }
}

document.querySelectorAll('input[type="checkbox"]').forEach(inp=>{
  inp.addEventListener("change", ()=>{
    guardarEstado();
    actualizarBloqueosDesdeEstado();
  });
});

actualizarBloqueosDesdeEstado();
document.getElementById("resetMalla").addEventListener("click", ()=>{
  localStorage.removeItem(STORAGE_KEY);
  location.reload();
});
</script>

</body>
</html>
